# Loading in packages
```{r}
library(tidyverse)
library(readxl)
library(ggpubr)
library(ggsignif)
library(ggprism)
library(openxlsx)
theme_set(theme_prism())
```

# Reading in Data
```{r}
# Reading in Data
dicty_total = read_excel(file.choose(), 
                         sheet = "Total_Cell_Output") %>% 
  mutate(Cell_Line = factor(Cell_Line, 
                            levels=c("AX2", "G120", "dDia2","VASP","mhcA"))) %>% 
  mutate(Plasmid = factor(Plasmid, 
                          levels = c("pDTi516", "pDTi571","pDTi557", "pDTi500"))) %>% 
  mutate(Transformation = factor(Transformation))


dicty_filo = read_excel(file.choose(), 
                   sheet = "Total_Filo_Output") %>% 
  mutate(Cell_Line = factor(Cell_Line, 
                            levels=c("AX2", "G120", "dDia2","VASP","mhcA"))) %>% 
    mutate(Plasmid = factor(Plasmid, 
                          levels = c("pDTi516", "pDTi571","pDTi557", "pDTi500"))) %>% 
  mutate(Transformation = factor(Transformation))

```

# Generating Summary Statistic Tables
```{r}
# Table Summaries of Data
totalcell_details = dicty_total %>% 
  mutate(Filopodia = ifelse(Filo_Number > 0,1,0)) %>%
  group_by(Cell_Line, Plasmid) %>% 
  summarize(Total_Cells= n(),
            Filopodia_Cells = sum(Filopodia == 1),
            Filopodia_Proportion = (Filopodia_Cells / Total_Cells) * 100,
            CortBody_Ratio_Avg = mean(Cortex_Body, na.rm = T),
            CortBody_Ratio_SD = sd(Cortex_Body, na.rm = T)/sqrt(Total_Cells)
            )

filopercell_details = dicty_total %>%
  group_by(Cell_Line, Plasmid) %>%
  filter(Filo_Number > 0) %>%
  summarize(Total_Cells = n(),
            FiloNum_Avg = mean(Filo_Number, na.rm = T),
            FiloNum_SD = sd(Filo_Number, na.rm = T)/sqrt(Total_Cells),
            Median_FiloNum = median(Filo_Number, na.rm = T),
            Filoper10um_Avg = mean(Filos_per_10um, na.rm = T),
            Filoper10um_sd = sd(Filos_per_10um, na.rm = T)/sqrt(Total_Cells)
            )

filo_length_details = dicty_filo %>%
  group_by(Cell_Line, Plasmid) %>%
  summarize(Total_Cells = n(),
            Filo_Length_Avg = mean(Filo_Length, na.rm =  T),
            Filo_Length_SD = sd(Filo_Length, na.rm = T)/sqrt(Total_Cells),
            Filo_Length_Median = median(Filo_Length, na.rm = T),
            Tip_Avg = mean(Filo_Body_Int, na.rm = T),
            Tip_SD = sd(Filo_Body_Int, na.rm = T)/sqrt(Total_Cells)
            )

mytable_actin = cbind(totalcell_details[1:7],
                      filopercell_details[4:8],
                      filo_length_details[4:8]) %>%
  filter(Cell_Line %in% c("AX2", "G120", "dDia2", "VASP")) %>%
  filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500"))
mytable_actin

mytable_mhcA = cbind(totalcell_details[1:7],
                     filopercell_details[4:8],
                     filo_length_details[4:8]) %>%
  filter(Cell_Line %in% c("AX2", "G120", "mhcA"))
mytable_mhcA

mytable_all = cbind(totalcell_details[1:7],
                      filopercell_details[4:8],
                      filo_length_details[4:8])


totalcell_vasp = dicty_total %>% 
  filter(ID %in% c("AC47", "PW23", "PW32", "PW33", "PW34")) %>% 
  mutate(Filopodia = ifelse(Filo_Number > 0,1,0)) %>%
  group_by(ID) %>% 
  summarize(Total_Cells= n(),
            Filopodia_Cells = sum(Filopodia == 1),
            Filopodia_Proportion = (Filopodia_Cells / Total_Cells) * 100,
            CortBody_Ratio_Avg = mean(Cortex_Body, na.rm = T),
            CortBody_Ratio_SD = sd(Cortex_Body, na.rm = T)/sqrt(Total_Cells)
            )

filopercell_vasp = dicty_total %>%
  filter(ID %in% c("AC47", "PW23", "PW32", "PW33", "PW34")) %>% 
  group_by(ID) %>%
  filter(Filo_Number > 0) %>%
  summarize(Total_Cells = n(),
            FiloNum_Avg = mean(Filo_Number, na.rm = T),
            FiloNum_SD = sd(Filo_Number, na.rm = T)/sqrt(Total_Cells),
            Median_FiloNum = median(Filo_Number, na.rm = T),
            Filoper10um_Avg = mean(Filos_per_10um, na.rm = T),
            Filoper10um_sd = sd(Filos_per_10um, na.rm = T)/sqrt(Total_Cells)
            )

filo_length_vasp = dicty_filo %>%
  filter(ID %in% c("AC47", "PW23", "PW32", "PW33", "PW34")) %>% 
  group_by(ID) %>%
  summarize(Total_Cells = n(),
            Filo_Length_Avg = mean(Filo_Length, na.rm =  T),
            Filo_Length_SD = sd(Filo_Length, na.rm = T)/sqrt(Total_Cells),
            Filo_Length_Median = median(Filo_Length, na.rm = T),
            Tip_Avg = mean(Filo_Body_Int, na.rm = T),
            Tip_SD = sd(Filo_Body_Int, na.rm = T)/sqrt(Total_Cells)
            )

mytable_vasp =  cbind(totalcell_vasp,
                      filopercell_vasp[3:7],
                      filo_length_vasp[3:7])

write.xlsx(mytable_all, file = "HMM_DataTable.xlsx")
```

# Outlier Test
```{r, echo = FALSE}
# # Rosner Outlier Test
# filonum_outliers = EnvStats::rosnerTest(dicty_total_trim$Filo_Number,
#                               k = 2)
# 
# cortexcellbody_outliers = EnvStats::rosnerTest(dicty_total$Cortex_Body,
#                                       k = 10)
# 
# filolength_outliers = EnvStats::rosnerTest(dicty_filo$Filo_Length,
#                                  k = 20)
```

# Statistical Tests
```{r, echo=FALSE}
# Stats on variables
# data_trim = dicty_total %>%
#   filter(Cell_Line %in% c("mhcA"))
# 
# dicty_total_trim = dicty_total %>%
#   group_by(Cell_Line, Plasmid) %>%
#   filter(Filo_Number > 0) %>%
#   filter(Cell_Line %in% c("mhcA"))
# 
# dicty_filo_trim = dicty_filo %>%
#   filter(Cell_Line %in% c("mhcA"))
# 
# 
# filo_num_mod = aov(Filo_Number ~  Plasmid, data = dicty_total_trim)
# summary(filo_num_mod)
# TukeyHSD(filo_num_mod, "Plasmid")
# 
# cortexcellbody_mod = aov(Cortex_Body ~  Plasmid, data = data_trim)
# summary(cortexcellbody_mod)
# TukeyHSD(cortexcellbody_mod, "Plasmid")
# 
# filo_length_mod = aov(Filo_Length ~  Plasmid, data = dicty_filo_trim)
# summary(filo_length_mod)
# TukeyHSD(filo_length_mod, "Plasmid")
# 
# tip_int_mod = aov(Filo_Body_Int ~  Plasmid, data = dicty_filo_trim)
# summary(tip_int_mod)
# TukeyHSD(tip_int_mod, "Plasmid")



## For Multiple Cell Lines
# filo_num_mod = aov(Filo_Number ~ Cell_Line * Plasmid,
#       data = dicty_total_trim)
# TukeyHSD(filo_num_mod, "Cell_Line:Plasmid")
# 
# cortexcellbody_mod = aov(Cortex_Body ~ Cell_Line * Plasmid,
#                          data = dicty_total_trim)
# TukeyHSD(cortexcellbody_mod, "Cell_Line:Plasmid")
# 
# filo_length_mod = aov(Filo_Length ~ Cell_Line * Plasmid,
#                       data = dicty_filo_trim)
# TukeyHSD(filo_length_mod, "Cell_Line:Plasmid")
# 
# tip_int_mod = aov(Filo_Body_Int ~ Cell_Line * Plasmid,
#                   data = dicty_filo_trim)
# TukeyHSD(tip_int_mod, "Cell_Line:Plasmid")
# 
# filoper10_mod = aov(Filos_per_10um ~ Cell_Line * Plasmid,
#                   data = dicty_total_trim)
# summary(filoper10_mod)
# TukeyHSD(tip_int_mod, "Cell_Line:Plasmid")



## For VASP i516 investigation
vasp_i516 = dicty_total %>%
  filter(Cell_Line %in% c("VASP")) %>%
  filter(Plasmid == "pDTi516")

i516 = dicty_total %>%
  filter(Cell_Line %in% c("VASP", "AX2", "G120")) %>%
  filter(Plasmid == "pDTi516")

filo_num_mod = aov(Filo_Number ~  ID, data = vasp_i516)
summary(filo_num_mod)
TukeyHSD(filo_num_mod, "ID")

filo_num_mod = aov(Filo_Number ~  Cell_Line, data = i516)
summary(filo_num_mod)
TukeyHSD(filo_num_mod, "Cell_Line")


# ## For AX2, G120 and mhcA i516 investigation
# i516 = dicty_total %>%
#   filter(Cell_Line %in% c("VASP","AX2", "G120")) %>%
#   filter(Plasmid == "pDTi516")
# 
# filo_num_mod = aov(Filo_Number ~ Cell_Line, data = vasp_i516)
# summary(filo_num_mod)
# TukeyHSD(filo_num_mod, "Cell_Line")
# 
# filo_per_mod = aov(Filos_per_10um ~ Cell_Line , data = vasp_i516)
# summary(filo_per_mod)
# TukeyHSD(filo_per_mod, "Cell_Line")

```

# Graphing 

## AX2 Graphs

```{r}
ax2 = mytable_actin %>% 
  filter(Cell_Line == "AX2")

(ax2_fxnfilo = dicty_total %>%
   filter(Cell_Line %in% c("AX2")) %>% 
    filter(Filo_Number >0) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Number, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = ax2,
              aes(y = FiloNum_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =ax2,
                 aes(y = FiloNum_Avg,,
                     ymin = FiloNum_Avg - FiloNum_SD,
                     ymax = FiloNum_Avg + FiloNum_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("AX2 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Average Filopodia Per Cell") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
    map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black"
   ) +
   geom_signif(
     comparisons = list(c("pDTi516", "pDTi500")),
    map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 32
   )
)

(ax2_cortex = dicty_total %>%
   filter(Cell_Line %in% c("AX2")) %>% 
    ggplot(aes(x = Plasmid, y = Cortex_Body, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = ax2,
              aes(y = CortBody_Ratio_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =ax2,
                 aes(y = FiloNum_Avg,,
                     ymin = CortBody_Ratio_Avg - CortBody_Ratio_SD,
                     ymax = CortBody_Ratio_Avg + CortBody_Ratio_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("AX2 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
    ylim(0,2.5)+
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "DdMyo7 Localization") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 2
   )
)

(ax2_length = dicty_filo %>%
   filter(Cell_Line %in% c("AX2")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Length, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = ax2,
              aes(y = Filo_Length_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =ax2,
                 aes(y = FiloNum_Avg,,
                     ymin = Filo_Length_Avg - Filo_Length_SD,
                     ymax = Filo_Length_Avg + Filo_Length_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("AX2 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Filopodial Length (um)") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black"
   )
)

(ax2_tip = dicty_filo %>%
   filter(Cell_Line %in% c("AX2")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Body_Int, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = ax2,
              aes(y = Tip_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =ax2,
                 aes(y = Tip_Avg,
                     ymin = Tip_Avg - Tip_SD,
                     ymax = Tip_Avg + Tip_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("AX2 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Tip:Body Intensity") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 28
   ) +
   geom_signif(
     comparisons = list(c("pDTi516", "pDTi500")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black"
   )
)

ax2 = list(ax2_fxnfilo,ax2_cortex,ax2_length,ax2_tip)

ggsave(ax2_fxnfilo,file = "HMM_Images/AX2_filo.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(ax2_cortex,file = "HMM_Images/AX2_cortex.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(ax2_length,file = "HMM_Images/AX2_length.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(ax2_tip,file = "HMM_Images/AX2_tip.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
```





## G1-20
```{r}
G120 = mytable_actin %>% 
  filter(Cell_Line == "G120")

(G120_fxnfilo = dicty_total %>%
   filter(Cell_Line %in% c("G120")) %>% 
    filter(Filo_Number >0) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Number, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = G120,
              aes(y = FiloNum_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =G120,
                 aes(y = FiloNum_Avg,,
                     ymin = FiloNum_Avg - FiloNum_SD,
                     ymax = FiloNum_Avg + FiloNum_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("G120 Cells") +
    ylim(0,40) +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Average Filopodia Per Cell") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 32
   ) +
   geom_signif(
     comparisons = list(c("pDTi516", "pDTi500")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 35
   )
)

(G120_cortex = dicty_total %>%
   filter(Cell_Line %in% c("G120")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Cortex_Body, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = G120,
              aes(y = CortBody_Ratio_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =G120,
                 aes(y = FiloNum_Avg,,
                     ymin = CortBody_Ratio_Avg - CortBody_Ratio_SD,
                     ymax = CortBody_Ratio_Avg + CortBody_Ratio_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("G120 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
    ylim(0,2.5)+
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "DdMyo7 Localization")
)

(G120_length = dicty_filo %>%
   filter(Cell_Line %in% c("G120")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Length, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = G120,
              aes(y = Filo_Length_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =G120,
                 aes(y = FiloNum_Avg,,
                     ymin = Filo_Length_Avg - Filo_Length_SD,
                     ymax = Filo_Length_Avg + Filo_Length_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("G120 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Filopodial Length (um)") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 10.5
   ) +
    geom_signif(
     comparisons = list(c("pDTi571", "pDTi500")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black"
   ) +
   geom_signif(
     comparisons = list(c("pDTi516", "pDTi500")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 11.5
   )
)

(G120_tip = dicty_filo %>%
   filter(Cell_Line %in% c("G120")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Body_Int, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = G120,
              aes(y = Tip_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =G120,
                 aes(y = Tip_Avg,
                     ymin = Tip_Avg - Tip_SD,
                     ymax = Tip_Avg + Tip_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("G120 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Tip:Body Intensity") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black"
   ) +
   geom_signif(
     comparisons = list(c("pDTi516", "pDTi500")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 17
   )
)

G120 = list(G120_fxnfilo,G120_cortex,G120_length,G120_tip)

ggsave(G120_fxnfilo,file = "HMM_Images/G120_filo.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(G120_cortex,file = "HMM_Images/G120_cortex.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(G120_length,file = "HMM_Images/G120_length.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(G120_tip,file = "HMM_Images/G120_tip.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
```

## Vasp 
```{r}
VASP = mytable_actin %>% 
  filter(Cell_Line == "VASP")

(VASP_fxnfilo = dicty_total %>%
  filter(Filo_Number >0) %>% 
   filter(Cell_Line %in% c("VASP")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Number, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = VASP,
              aes(y = FiloNum_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =VASP,
                 aes(y = FiloNum_Avg,,
                     ymin = FiloNum_Avg - FiloNum_SD,
                     ymax = FiloNum_Avg + FiloNum_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("VASP Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Average Filopodia Per Cell")
)

(VASP_cortex = dicty_total %>%
   filter(Cell_Line %in% c("VASP")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Cortex_Body, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = VASP,
              aes(y = CortBody_Ratio_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =VASP,
                 aes(y = FiloNum_Avg,,
                     ymin = CortBody_Ratio_Avg - CortBody_Ratio_SD,
                     ymax = CortBody_Ratio_Avg + CortBody_Ratio_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("VASP Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
    ylim(0,2.5)+
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "DdMyo7 Localization") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black"
   )
)

(VASP_length = dicty_filo %>%
   filter(Cell_Line %in% c("VASP")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Length, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = VASP,
              aes(y = Filo_Length_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =VASP,
                 aes(y = FiloNum_Avg,,
                     ymin = Filo_Length_Avg - Filo_Length_SD,
                     ymax = Filo_Length_Avg + Filo_Length_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("VASP Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Filopodial Length (um)")
)

(VASP_tip = dicty_filo %>%
   filter(Cell_Line %in% c("VASP")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Body_Int, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = VASP,
              aes(y = Tip_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =VASP,
                 aes(y = Tip_Avg,
                     ymin = Tip_Avg - Tip_SD,
                     ymax = Tip_Avg + Tip_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("VASP Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Tip:Body Intensity")
)

VASP = list(VASP_fxnfilo,VASP_cortex,VASP_length,VASP_tip)

ggsave(VASP_fxnfilo,file = "HMM_Images/VASP_filo.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(VASP_cortex,file = "HMM_Images/VASP_cortex.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(VASP_length,file = "HMM_Images/VASP_length.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(VASP_tip,file = "HMM_Images/VASP_tip.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
```

## VASP i516 Comparison
```{r}

# Analysis of i516 by person
(VASP_filo_ID = dicty_total %>%
  filter(Filo_Number >0) %>% 
   filter(Cell_Line %in% c("VASP")) %>% 
   filter(Plasmid %in% c("pDTi516")) %>% 
    ggplot(aes(x = ID, y = Filo_Number)) +
    geom_jitter(width = 0.15,
              alpha = 0.5,
              color = "magenta") +
     geom_point(data = mytable_vasp,
              aes(y = FiloNum_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =mytable_vasp,
                 aes(y = FiloNum_Avg,
                     ymin = FiloNum_Avg - FiloNum_SD,
                     ymax = FiloNum_Avg + FiloNum_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("VASP w/ varying FL DdMyo7 Transformations") +
   theme(legend.position = "bottom") +
   labs(y = "Average Filopodia Per Cell") +
   geom_signif(
     comparisons = list(c("PW23", "PW32")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 11
   ) +
   geom_signif(
     comparisons = list(c("PW23", "PW33")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
   )
)

# AX2 pDTi516 vs G120 i516 vs VASP i516

vasp_mini = mytable_all %>% 
  filter(Cell_Line %in% c("AX2", "G120","VASP")) %>% 
  filter(Plasmid == "pDTi516")

(vasp_i516 = dicty_total %>%
  filter(Filo_Number > 0) %>% 
   filter(Cell_Line %in% c("AX2", "G120", "VASP")) %>% 
   filter(Plasmid %in% c("pDTi516")) %>% 
    ggplot(aes(x = Cell_Line, y = Filo_Number, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
     geom_point(data = vasp_mini,
              aes(y = FiloNum_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =vasp_mini,
                 aes(y = FiloNum_Avg,
                     ymin = FiloNum_Avg - FiloNum_SD,
                     ymax = FiloNum_Avg + FiloNum_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("FL DdMyo7 in AX2, G120 & VASP") +
   theme(legend.position = "bottom") +
   labs(y = "Average Filopodia Per Cell",
        x = "Cell Line") +
   geom_signif(
     comparisons = list(c("AX2", "VASP")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 33
   ) +
  geom_signif(
     comparisons = list(c("G120", "VASP")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 31
   )
)

ggsave(VASP_filo_ID,file = "HMM_Images/VASP_ID.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(vasp_i516,file = "HMM_Images/vasp_i516.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)

```

## dDia2 
``` {r}
dDia2 = mytable_actin %>% 
  filter(Cell_Line == "dDia2" )

(dDia2_fxnfilo = dicty_total %>%
   filter(Cell_Line %in% c("dDia2", "dDia2")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Number, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = dDia2,
              aes(y = FiloNum_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =dDia2,
                 aes(y = FiloNum_Avg,,
                     ymin = FiloNum_Avg - FiloNum_SD,
                     ymax = FiloNum_Avg + FiloNum_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("dDia2 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Average Filopodia Per Cell") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 48
   ) +
   geom_signif(
     comparisons = list(c("pDTi516", "pDTi500")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 50
   )
)

(dDia2_cortex = dicty_total %>%
   filter(Cell_Line %in% c("dDia2")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Cortex_Body, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = dDia2,
              aes(y = CortBody_Ratio_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =dDia2,
                 aes(y = FiloNum_Avg,,
                     ymin = CortBody_Ratio_Avg - CortBody_Ratio_SD,
                     ymax = CortBody_Ratio_Avg + CortBody_Ratio_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
    ylim(0,1.7) +
   ggtitle("dDia2 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "DdMyo7 Localization") 
)

(dDia2_length = dicty_filo %>%
   filter(Cell_Line %in% c("dDia2")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Length, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = dDia2,
              aes(y = Filo_Length_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =dDia2,
                 aes(y = FiloNum_Avg,,
                     ymin = Filo_Length_Avg - Filo_Length_SD,
                     ymax = Filo_Length_Avg + Filo_Length_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("dDia2 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Filopodial Length (um)") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black"
   ) 
)

(dDia2_tip = dicty_filo %>%
   filter(Cell_Line %in% c("dDia2")) %>% 
   filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Body_Int, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = dDia2,
              aes(y = Tip_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =dDia2,
                 aes(y = Tip_Avg,
                     ymin = Tip_Avg - Tip_SD,
                     ymax = Tip_Avg + Tip_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("dDia2 Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Tip:Body Intensity") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 12
   ) +
    geom_signif(
     comparisons = list(c("pDTi571", "pDTi500")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 11
   ) 
)


ggsave(dDia2_fxnfilo,file = "HMM_Images/dDia2_filo.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(dDia2_cortex,file = "HMM_Images/dDia2_cortex.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(dDia2_length,file = "HMM_Images/dDia2_length.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(dDia2_tip,file = "HMM_Images/dDia2_tip.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
```

## mhcA null cells
```{r}
mhcA = mytable_mhcA %>% 
  filter(Cell_Line %in% c("mhcA")) %>% 
  filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) 

(mhcA_fxnfilo = dicty_total %>%
   filter(Cell_Line %in% c("mhcA")) %>% 
    filter(Filo_Number > 0) %>% 
    filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Number, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = mhcA,
              aes(y = FiloNum_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =mhcA,
                 aes(y = FiloNum_Avg,,
                     ymin = FiloNum_Avg - FiloNum_SD,
                     ymax = FiloNum_Avg + FiloNum_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("mhcA Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Average Filopodia Per Cell") 
)

(mhcA_cortex = dicty_total %>%
   filter(Cell_Line %in% c("mhcA")) %>% 
    filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Cortex_Body, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = mhcA,
              aes(y = CortBody_Ratio_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =mhcA,
                 aes(y = FiloNum_Avg,,
                     ymin = CortBody_Ratio_Avg - CortBody_Ratio_SD,
                     ymax = CortBody_Ratio_Avg + CortBody_Ratio_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("mhcA Cells") +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
    ylim(0,2.1)+
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "DdMyo7 Localization") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 1.5
   ) +
    geom_signif(
     comparisons = list(c("pDTi571", "pDTi500")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 1.9
     )
)

(mhcA_length = dicty_filo %>%
   filter(Cell_Line %in% c("mhcA")) %>% 
    filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Length, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = mhcA,
              aes(y = Filo_Length_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =mhcA,
                 aes(y = FiloNum_Avg,,
                     ymin = Filo_Length_Avg - Filo_Length_SD,
                     ymax = Filo_Length_Avg + Filo_Length_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("mhcA Cells") +
    ylim(0,16) +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Filopodial Length (um)")
)

(mhcA_tip = dicty_filo %>%
   filter(Cell_Line %in% c("mhcA")) %>% 
    filter(Plasmid %in% c("pDTi516", "pDTi571", "pDTi500")) %>% 
    ggplot(aes(x = Plasmid, y = Filo_Body_Int, color = Transformation)) +
    geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = mhcA,
              aes(y = Tip_Avg),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  size = 1.75) +
   geom_errorbar(data =mhcA,
                 aes(y = Tip_Avg,
                     ymin = Tip_Avg - Tip_SD,
                     ymax = Tip_Avg + Tip_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 size = 1,
                 width = 0.15) +
   ggtitle("mhcA Cells") +
    ylim(0,18) +
   theme(axis.title.x = element_blank(),
         legend.position = "bottom") +
   scale_x_discrete(breaks = c("pDTi516",
                               "pDTi571",
                               "pDTi500"),
                    labels = c("FL DdMyo7",
                             "Antiparallel Dimer", 
                             "Parallel Dimer GFP"),
                    guide = guide_axis(n.dodge = 2)) +
   labs(y = "Tip:Body Intensity") +
   geom_signif(
     comparisons = list(c("pDTi571", "pDTi516")),
     color = "black",
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     y_position = 12
   )
)

ggsave(mhcA_fxnfilo,file = "HMM_Images/mhcA_filo.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(mhcA_cortex,file = "HMM_Images/mhcA_cortex.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(mhcA_length,file = "HMM_Images/mhcA_length.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(mhcA_tip,file = "HMM_Images/mhcA_tip.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
```

## AX2 pDTi516 vs mhcA null cells 
```{r}
mhcA_AX2 = mytable_mhcA %>% 
  filter(Cell_Line %in% c("AX2", "mhcA", "G120")) %>% 
  filter(Plasmid %in% c("pDTi516"))

(mhcA_AX2_fxnfilo = dicty_total %>%
     filter(Filo_Number > 0) %>%
    filter(Cell_Line %in% c("AX2","G120", "mhcA")) %>% 
    filter(Plasmid == "pDTi516") %>% 
    ggplot(aes(x = Cell_Line, y = Filo_Number, color = Transformation )) +
        geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = mhcA_AX2,
              aes(y = FiloNum_Avg,
                  group_by = Plasmid),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  alpha = 0.5,
                  size = 1.5) +
   geom_errorbar(data =mhcA_AX2,
                 aes(y = FiloNum_Avg,
                     group_by = Plasmid,
                     ymin = FiloNum_Avg - FiloNum_SD,
                     ymax = FiloNum_Avg + FiloNum_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 alpha = 0.5,
                 size = 1,
                 width = 0.2) +
    labs(y = "Average Filopodia Per Cell") +
    theme(axis.title.x = element_blank(),
          legend.position = "bottom") +
    geom_signif(
     comparisons = list(c("G120", "mhcA")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black"
     )
)

(mhcA_AX2_filoper10 = dicty_total %>%
    filter(Cell_Line %in% c("AX2","G120", "mhcA")) %>% 
   filter(Plasmid == "pDTi516") %>% 
    filter(Filo_Number > 0) %>%
    ggplot(aes(x = Cell_Line, y = Filos_per_10um, color = Transformation)) +
        geom_jitter(width = 0.15,
              alpha = 0.5) +
   geom_point(data = mhcA_AX2,
              aes(y = Filoper10um_Avg,
                  group_by = Cell_Line),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  alpha = 0.5,
                  size = 1.5) +
   geom_errorbar(data =mhcA_AX2,
                 aes(y = Filoper10um_Avg,
                     group_by = Cell_Line,
                     ymin = Filoper10um_Avg - Filoper10um_sd,
                     ymax = Filoper10um_Avg + Filoper10um_sd),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 alpha = 0.5,
                 size = 1,
                 width = 0.2) +
    labs(y = "Average Filopodia / 10um") +
    theme(axis.title.x = element_blank(),
          legend.position = "bottom") +
    geom_signif(
     comparisons = list(c("G120", "mhcA")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black"
     ) +
    geom_signif(
     comparisons = list(c("AX2", "mhcA")),
     map_signif_level=c(" "=0.001," "=0.01, " "=0.05, " "=2),
     color = "black",
     y_position = 5.5
     )
)

ggsave(mhcA_AX2_fxnfilo, file = "HMM_Images/mhcA_AX2_fxnfilo.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
ggsave(mhcA_AX2_filoper10, file = "HMM_Images/mhcA_AX2_filoper10.tiff",
       width = 5,
       height = 5,
       units = "cm",
       scaling = 0.35,
       dpi = 600)
```


## pDTi516 v pDTi571 v pDTi557 v pDTi500
```{r}
mhcA_G120 = mytable_mhcA %>% 
  filter(Cell_Line  %in% c("G120", "mhcA"))

(mhcA_G120_fxnfilo = dicty_total %>%
    filter(Cell_Line %in% c("G120", "mhcA")) %>% 
    
    ggplot(aes(x = Cell_Line, y = Filo_Number, color =Plasmid)) +
    ggforce::geom_sina(scale =F) +
   geom_point(data = mhcA_G120,
              aes(y = FiloNum_Avg,
                  group_by = Plasmid),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  alpha = 0.5,
                  size = 1.5) +
   geom_errorbar(data =mhcA_G120,
                 aes(y = FiloNum_Avg,
                     group_by = Plasmid,
                     ymin = FiloNum_Avg - FiloNum_SD,
                     ymax = FiloNum_Avg + FiloNum_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 alpha = 0.5,
                 size = 1,
                 width = 0.2) +
       scale_color_manual(breaks = c("pDTi516", "pDTi571","pDTi557", "pDTi500"),
                          labels = c("FL DdMyo7", "Antiparallel","Parallel mNG", "Parallel GFP"),
                         values = c("#00ba39", "#609cff","#FF00FF", "#f8766d")) +
    labs(y = "Average Filopodia Per Cell") +
    theme(axis.title.x = element_blank(),
          legend.box.background = element_rect(color = "black"),
          legend.position = c(0.75,0.85))
)

(mhcA_G120_fxnfiloper10um = dicty_total %>%
    filter(Cell_Line %in% c("G120", "mhcA")) %>% 
    filter(Filo_Number > 0) %>% 
    ggplot(aes(x = Cell_Line, y = Filos_per_10um, color =Plasmid)) +
    ggforce::geom_sina(scale =F) +
   geom_point(data = mhcA_G120,
              aes(y = Filoper10um_Avg,
                  group_by = Plasmid),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  alpha = 0.5,
                  size = 1.5) +
   geom_errorbar(data =mhcA_G120,
                 aes(y = Filoper10um_Avg,
                     group_by = Plasmid,
                     ymin = Filoper10um_Avg - Filoper10um_sd,
                     ymax = Filoper10um_Avg + Filoper10um_sd),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 alpha = 0.5,
                 size = 1,
                 width = 0.2) +
       scale_color_manual(breaks = c("pDTi516", "pDTi571","pDTi557", "pDTi500"),
                          labels = c("FL DdMyo7", "Antiparallel","Parallel mNG", "Parallel GFP"),
                         values = c("#00ba39", "#609cff","#FF00FF", "#f8766d")) +
    labs(y = "Average Filopodia / 10um") +
    theme(axis.title.x = element_blank(),
          legend.box.background = element_rect(color = "black"),
          legend.position = c(0.75,0.85))
)

(mhcA_G120_cortex= dicty_total %>%
     filter(Cell_Line %in% c("G120", "mhcA")) %>% 
    ggplot(aes(x = Cell_Line, y = Cortex_Body, color =Plasmid)) +
    ggforce::geom_sina(scale =F) +
   geom_point(data = mhcA_G120,
              aes(y = CortBody_Ratio_Avg,
                  group_by = Plasmid),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  alpha = 0.5,
                  size = 1.5) +
   geom_errorbar(data =mhcA_G120,
                 aes(y = CortBody_Ratio_Avg,
                     group_by = Plasmid,
                     ymin = CortBody_Ratio_Avg - CortBody_Ratio_SD,
                     ymax = CortBody_Ratio_Avg + CortBody_Ratio_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 alpha = 0.5,
                 size = 1,
                 width = 0.2) +
    geom_hline(yintercept = 1,
               linetype ="dashed") +
    scale_color_manual(breaks = c("pDTi516", "pDTi571","pDTi557", "pDTi500"),
                       labels = c("FL DdMyo7", "Antiparallel","Parallel mNG", "Parallel GFP"),
                         values = c("#00ba39", "#609cff","#FF00FF", "#f8766d")) +
    labs(y = "Cortex:Cell Body Ratio") +
    theme(axis.title.x = element_blank(),
          legend.box.background = element_rect(color = "black"),
          legend.position = c(0.9,0.85)) +
    ylim(0.5,2)
)

mhcA_G120_filo = dicty_filo %>% 
  filter(Cell_Line %in% c("G120", "mhcA"))

(mhcA_G120_length = mhcA_G120_filo %>%
     filter(Cell_Line %in% c("G120", "mhcA")) %>% 
    group_by(Cell_Line, Plasmid) %>% 
    ggplot(aes(x = Cell_Line,
               y = Filo_Length,
               color = Plasmid)) +
    ggforce::geom_sina(scale =F) +
   geom_point(data = mhcA_G120,
              aes(y = Filo_Length_Avg,
                  group_by = Plasmid),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  alpha = 0.5,
                  size = 1.5) +
   geom_errorbar(data = mhcA_G120,
                 aes(y = Filo_Length_Avg,
                     group_by = Plasmid,
                     ymin = Filo_Length_Avg - Filo_Length_SD,
                     ymax = Filo_Length_Avg + Filo_Length_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 alpha = 0.5,
                 size = 1,
                 width = 0.2) +
    scale_color_manual(breaks = c("pDTi516", "pDTi571","pDTi557", "pDTi500"),
                       labels = c("FL DdMyo7", "Antiparallel","Parallel mNG", "Parallel GFP"),
                         values = c("#00ba39", "#609cff","#FF00FF", "#f8766d")) +
      theme(axis.title.x = element_blank(),
            legend.box.background = element_rect(color = "black"),
          legend.position = c(0.9,0.85)) +
    labs(y = "Filopodia Length (um)",
         x = "Cell Line")
)

(mhcA_G120_tipint = mhcA_G120_filo %>%
     filter(Cell_Line %in% c("G120", "mhcA")) %>% 
    group_by(Cell_Line, Plasmid) %>% 
    ggplot(aes(x = Cell_Line,
               y = Filo_Body_Int,
               color = Plasmid)) +
    ggforce::geom_sina(scale =F) +
   geom_point(data = mhcA_G120,
              aes(y = Tip_Avg,
                  group_by = Plasmid),
                  position = position_dodge(width = 0.9),
                  color = "black",
                  alpha = 0.5,
                  size = 1.5) +
   geom_errorbar(data = mhcA_G120,
                 aes(y = Tip_Avg,
                     group_by = Plasmid,
                     ymin = Tip_Avg - Tip_SD,
                     ymax = Tip_Avg + Tip_SD),
                 position = position_dodge(width = 0.9),
                 color = "black",
                 alpha = 0.5,
                 size = 1,
                 width = 0.2) +
    scale_color_manual(breaks = c("pDTi516", "pDTi571","pDTi557", "pDTi500"),
                       labels = c("FL DdMyo7", "Antiparallel","Parallel mNG", "Parallel GFP"),
                         values = c("#00ba39", "#609cff","#FF00FF", "#f8766d")) +
      theme(axis.title.x = element_blank()) +
    labs(y = "Filopodia Tip:Cell Body Intensity",
         x = "Cell Line")
)

```




